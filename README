Wrote this several years ago and thought someone might find it useful.
